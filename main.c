#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <conio.h>

#define HEIGHT 22
#define WIDTH 22



void display_map(char map[HEIGHT][WIDTH], int currentYpos, int currentXpos)
{
    for (int y = 0; y < HEIGHT; y++)
    {
        for (int x = 0; x < WIDTH; x++)
        {
            if (y == currentYpos && x == currentXpos)
                putchar('o');
            else
                putchar(map[y][x]);
        }

        putchar('\n');
    }
}


void move(char user_choice, char map[HEIGHT][WIDTH], int * currentYpos, int * currentXpos)
{
    switch (user_choice)
    {
    case 'a':
        if (map[*currentYpos][*currentXpos - 1] != '*' && *currentXpos > 1)
            (*currentXpos)--;
            break;
        
    case 'd':
        if (map[*currentYpos][*currentXpos + 1] != '*' && *currentXpos != WIDTH - 1)
            (*currentXpos)++;
            break;
        
    case 'w':
        if (map[*currentYpos - 1][*currentXpos] != '*' && *currentYpos > 1)
            (*currentYpos)--;
            break;
        
    case 's':
        if (map[*currentYpos + 1][*currentXpos] != '*' && *currentYpos != HEIGHT - 1)
            (*currentYpos)++;
            break;
        
    }
}

int main()
{
    int numberOfSteps = 0;

    srand(time(NULL));

    char map[HEIGHT][WIDTH] =
    {
    { '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_', '_' },
    { '|', ' ', '*', '*', '*', '*', '*', '*', '*', '*', ' ', '*', '*', '*', ' ', ' ', '*', '*', ' ', ' ', ' ', '|' },
    { '|', ' ', ' ', '*', '*', '*', ' ', ' ', ' ', '*', ' ', ' ', ' ', ' ', '*', ' ', '*', '*', ' ', '*', '*', '|' },
    { '|', ' ', ' ', ' ', ' ', ' ', '*', '*', ' ', '*', '*', '*', '*', '*', '*', '*', '*', ' ', ' ', '*', '*', '|' },
    { '|', '*', ' ', '*', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '*', '*', ' ', ' ', '*', ' ', '|' },
    { '|', ' ', ' ', ' ', ' ', ' ', '*', ' ', '*', ' ', ' ', ' ', '*', '*', ' ', '*', '*', ' ', '*', ' ', ' ', '|' },
    { '|', ' ', ' ', ' ', '*', ' ', '*', '*', ' ', ' ', '*', '*', '*', '*', ' ', '*', '*', '*', '*', '*', ' ', '|' },
    { '|', '*', ' ', '*', '*', '*', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '*', ' ', '*', '*', ' ', '*', '*', ' ', '|' },
    { '|', '*', ' ', ' ', ' ', ' ', ' ', ' ', '*', ' ', ' ', ' ', '*', '*', ' ', ' ', '*', '*', '*', '*', ' ', '|' },
    { '|', ' ', '*', '*', ' ', '*', ' ', ' ', '*', '*', ' ', ' ', ' ', ' ', '*', ' ', ' ', '*', ' ', '*', '*', '|' },
    { '|', '*', '*', '*', ' ', '*', '*', '*', '*', ' ', ' ', ' ', ' ', ' ', '*', ' ', '*', '*', '*', ' ', ' ', '|' },
    { '|', '*', ' ', ' ', ' ', ' ', ' ', '*', '*', ' ', '*', ' ', '*', ' ', '*', '*', ' ', ' ', ' ', '*', '*', '|' },
    { '|', '*', '*', '*', ' ', ' ', ' ', '*', ' ', '*', ' ', ' ', ' ', '*', ' ', ' ', ' ', ' ', '*', '*', ' ', '|' },
    { '|', '*', '*', ' ', ' ', ' ', ' ', ' ', ' ', '*', ' ', ' ', '*', ' ', ' ', '*', ' ', '*', '*', '*', ' ', '|' },
    { '|', '*', ' ', ' ', '*', ' ', ' ', '*', '*', ' ', ' ', '*', '*', ' ', '*', ' ', ' ', ' ', '*', '*', '*', '|' },
    { '|', '*', '*', '*', '*', ' ', '*', '*', '*', '*', ' ', ' ', ' ', '*', ' ', '*', '*', ' ', ' ', ' ', ' ', '|' },
    { '|', '*', ' ', '*', '*', ' ', ' ', ' ', '*', ' ', ' ', ' ', ' ', ' ', ' ', '*', '*', ' ', '*', '*', ' ', '|' },
    { '|', ' ', ' ', ' ', '*', '*', ' ', ' ', '*', ' ', '*', ' ', ' ', ' ', ' ', ' ', ' ', '*', ' ', '*', ' ', '|' },
    { '|', '*', '*', ' ', ' ', ' ', '*', '*', '*', ' ', '*', ' ', '*', '*', ' ', ' ', ' ', '*', '*', ' ', '*', '|' },
    { '|', '*', '*', '*', ' ', ' ', ' ', ' ', '*', '*', '*', '*', ' ', ' ', '*', ' ', ' ', ' ', '*', ' ', ' ', '|' },
    { '|', '*', ' ', '*', '*', '*', '*', ' ', ' ', '*', ' ', ' ', '*', '*', '*', '*', ' ', ' ', '*', ' ', ' ', '|' },
    { '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-' }
    };
    int currentYpos = 1;
    int currentXpos = 1;

    int goalXpos = 16;
    int goalYpos = 19;

    map[currentYpos][currentXpos] = 'o';

    map[goalYpos][goalXpos] = 'x';

    while (1)
    {
        numberOfSteps++;
        char user_choice;
        user_choice = _getch();
        system("cls");
        move(user_choice, map, &currentYpos, &currentXpos);

        display_map(map, currentYpos, currentXpos);
    }   
    return 0;
}

